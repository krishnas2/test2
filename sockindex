<!doctype html>  
<html lang="en" ng-App="utApp">  
    <head>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.16/angular.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.1/angular-route.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.1/angular-material.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/1.3.3/ui-bootstrap-tpls.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
<style>
#Handshake {padding-top:50px;height:1500px;color: #fff; background-color: #009688;}
.btn-bs-file input[type="file"]{
    position: absolute;
    top: -9999999;
    filter: alpha(opacity=0);
    opacity: 0;
    width:50;
    height:50;
    outline: none;
    cursor: inherit;
}
.error{
  color: tomato; 
  font-size: 16px; 
  font-weight:bold;
  padding-top: 4px
}
</style>
    </head>
    <body ng-controller="utController" data-spy="scroll" data-target=".navbar"  data-offset="50">
<nav class="navbar navbar-inverse  navbar-fixed-top ">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" >
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
      <a class="navbar-brand" href="#process">UT Tool</a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav">
        <li class="active"><a href="#process">Home</a></li>
        <li><a href="#Handshake">Handshake <span class="glyphicon  btn-success " ng-show="handshakesuccess">&#xe013;</span></a> </li>
        <li><a href="#Object">Object</a></li>
		<li><a href="#JIRA">JIRA(Under Construction)</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="#"><span class="glyphicon glyphicon-user"></span> {{username}}</a></li>
      </ul>
    </div>
  </div>
</nav>
<br/><br/><br/><br/>
<div id="process">
        <h1>Hello World!</h1>
        <div>
		<div class="container">
<h2>Basic Progress Bar</h2>
<div class="progress">
<div class="progress-bar" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="100" style="width:{{value}}%">
  {{value}}% Complete
</div>

</div>
</div>
        <form id="form" id="chat_form">
            <input ng-model="chat_input" type="text">
            <input type="submit" value="Send" ng-click="join()">
        </form>
		</div>
		</div>
<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
<div id="Handshake" class="container-fluid">
<h1 class="container"> Step 1 : Handshake </h1>
<form class="form-horizontal" class="form-inline" role="form" name="handform">
<div class="form-group">
		<label for="Upload Type" class="col-sm-3 control-label">Upload Type</label>
				<div class="col-sm-4">
				 <select class="form-control" ng-model="upldtype" ng-options="x for x in ['Upload','Formfilling']" required>
				 <option value="">Select Type</option> 
					</select>
				</div>
				<div class="col-sm-3"></div>
		</div>

		<div ng-show="upldtype=='Formfilling'">
		<div class="form-group">
            <label for="username" class="col-sm-3 control-label">Org Username</label>
            <div class="col-sm-4">
                <input type="text" id="firstName" class="form-control" ng-model="details.username" name="envusername"required="true"/>
				<!--<div ng-show="handform.email.$error.email" class="error">Invalid Username!</div>-->
                <div ng-show="handform.envusername.$error.required &amp;&amp; handform.envusername.$touched" class="error">Required!</div>
            </div>
            <div class="col-sm-3"></div>

        </div>
        <div class="form-group">
            <label for="Password" class="col-sm-3 control-label">Password</label>
            <div class="col-sm-4">
                <input type="password" id="Password" class="form-control" ng-model="details.password" name="envpassword"required="true" />
				<div ng-show="handform.envpassword.$error.required &amp;&amp; handform.envpassword.$touched" class="error">Required!</div>
            </div>
            <div class="col-sm-3"></div>
        </div>
		<div class="form-group">
            <label for="clientid" class="col-sm-3 control-label">Client ID</label>
            <div class="col-sm-4">
                <input type="text" id="clientid" class="form-control" ng-model="details.clientid" name="envclientid"required="true"/>
				<div ng-show="handform.envclientid.$error.required &amp;&amp; handform.envclientid.$touched" class="error">Required!</div>
            </div>
            <div class="col-sm-3"></div>
        </div>
		<div class="form-group">
            <label for="secret" class="col-sm-3 control-label">Client secret</label>
            <div class="col-sm-4">
                <input type="text" id="secret" class="form-control" ng-model="details.clientsecret" name="envclientsecret" required="true" />
				<div ng-show="handform.envclientsecret.$error.required &amp;&amp; handform.envclientsecret.$touched" class="error">Required!</div>
            </div>
            <div class="col-sm-3"></div>
        </div>
		<div class="form-group">
            <label for="Upload Type" class="col-sm-3 control-label">Environment</label>
				<div class="col-sm-4">
				 <select class="form-control" ng-model="details.env" name="envtype" ng-options="x for x in ['Production','Sandbox']" required>
				 <option value="">Select Type</option> 
					</select>
					<div ng-show="handform.envtype.$error.required &amp;&amp; handform.envtype.$touched" class="error">Required!</div>
				</div>
				<div class="col-sm-3"></div>
        </div>
		</div>
	
		<div ng-show="upldtype=='Upload'">
		<div class="form-group">
		<label for="Type" class="col-sm-3 control-label">Details</label>
				<div class="col-sm-7 row-sm-5">
				 <pre>{{ fileContent }}</pre>
				</div>
		</div>
		<div class="form-group">
		<label for="Type" class="col-sm-3 control-label"></label>
				<div class="col-sm-7 row-sm-5">
				 <div class="btn-bs-file btn btn-lg btn-danger">
                <span>Choose file</span>
                <input type="file" id="myFileInput" class="btn" ng-model="inptfile" name="envinputfile" onchange="angular.element(this).scope().submit()" />
            </div>
				</div>
		</div>

      </div>
	  <div class="row">
    <div class="col-xs-11">
        <div class="text-right">
            <button type="button" class="btn btn-danger" ng-click="captureddetails()">Next</button>
        </div>
    </div>
</div>
</form>
<div ng-show="showhandshakeprogress">
			<div class="container">
		<h2>Salesforce Org Connection Status</h2>
		<div class="progress">
		<div class="progress-bar" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="100" style="width:{{value}}%">
		  {{value}}% Complete
		</div>

		</div>
		<div class="form-check">
    <input type="checkbox" class="filled-in form-check-input" id="checkbox101"  ng-model="showsfdcconlog">
    <label class="form-check-label" for="checkbox101">Show Logs</label>
</div>
<div  ng-show="showsfdcconlog">

				 <pre>{{ sfdccon }}</pre>
		</div>
		</div>
		
		</div>
</div>  
<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
<div id="Object">
Object
</div>

  <script src="/socket.io/socket.io.js"></script>
   
		<script>  
	'use strict';	
		var app = angular.module('utApp', ['ui.bootstrap','ngRoute']);
		app.factory('socket', ['$rootScope', function($rootScope) {
  var socket = io.connect();

  return {
    on: function(eventName, callback){
      socket.on(eventName, callback);
    },
    emit: function(eventName, data) {
      socket.emit(eventName, data);
    }
  };
}]);

app.controller('utController', function($scope,$http, socket) {
$scope.handshakesuccess=false;
$scope.showsfdcconlog=true;
  $scope.join = function() {
    socket.emit('joined', $scope.chat_input);
  };
socket.on('connect', function(data) {
    socket.emit('join', 'Hello World from client');
 });
  socket.on('broad', function(data) {
  console.log(data);
    $scope.value=data;
	//$state.reload();
	$scope.$apply();
  });
  socket.on('username', function(data) {
  console.log(data);
    $scope.username=data;
	//$state.reload();
	$scope.$apply();
  });
  socket.on('sfdccomslog', function(data) {
  console.log(data);
    $scope.sfdccon+=data;
	//$state.reload();
	$scope.$apply();
  });
  socket.on('sfdccoms', function(data) {
  console.log(data);
    $scope.value=data;
	//$state.reload();
	$scope.$apply();
  });

  $scope.fileContent = '';
        $scope.fileSize = 0;
        $scope.fileName = '';
        $scope.submit = function () {
          var file = document.getElementById("myFileInput").files[0];
          if (file) {
		  console.log(file);
            var aReader = new FileReader();
            aReader.readAsText(file, "UTF-8");
            aReader.onload = function (evt) {
                document.getElementById("myFileInput").innerHTML = evt.target.result;
                $scope.fileContent = aReader.result;
                $scope.fileName = document.getElementById("myFileInput").files[0].name;
        				$scope.fileSize = document.getElementById("myFileInput").files[0].size;
				var temp=JSON.parse(evt.target.result);
				console.log(temp.username);
				$scope.details.username=temp.username;
				$scope.details.password=temp.password;
				$scope.details.clientid=temp.clientid;
				$scope.details.clientsecret=temp.clientsecret;
				$scope.details.env=temp.env;
				$scope.$apply();
            }
            aReader.onerror = function (evt) {
                document.getElementById("myFileInput").innerHTML = "error";
                $scope.fileContent = "error";
            }
          }
        }
  
  
  $scope.captureddetails=function(){
	$scope.showhandshakeprogress=true;
	socket.emit('sfdcdetails', $scope.details);
  }
  });
  
</script>
    </body>
</html>
